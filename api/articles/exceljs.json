{"title":"exceljs 导出表格","slug":"exceljs","date":"2022-03-16T16:00:00.000Z","updated":"2022-10-19T14:40:00.248Z","comments":true,"path":"api/articles/exceljs.json","realPath":"/2022/exceljs/index/","excerpt":null,"covers":null,"cover":null,"content":"<p>工作中我们可能会遇到制作表格的需求，那么针对nodejs如何制作一个汇总表格呢？今天我们就在此介绍下<a href=\"https://github.com/guyonroche/exceljs\">exceljs</a>的基本使用，应该可以满足我们大部分的需求。</p>\n<h3 id=\"第一部分-下载\"><a href=\"#第一部分-下载\" class=\"headerlink\" title=\"第一部分 下载\"></a>第一部分 下载</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install exceljs</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"第二部分-基本的配置\"><a href=\"#第二部分-基本的配置\" class=\"headerlink\" title=\"第二部分 基本的配置\"></a>第二部分 基本的配置</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> <span class=\"title class_\">Excel</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;exceljs&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> workbook = <span class=\"keyword\">new</span> <span class=\"title class_\">Excel</span>.<span class=\"title class_\">Workbook</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 基本的创建信息</span></span><br><span class=\"line\">workbook.<span class=\"property\">creator</span> = <span class=\"string\">&quot;Me&quot;</span>;</span><br><span class=\"line\">workbook.<span class=\"property\">lastModifiedBy</span> = <span class=\"string\">&quot;Her&quot;</span>;</span><br><span class=\"line\">workbook.<span class=\"property\">created</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(<span class=\"number\">1985</span>, <span class=\"number\">8</span>, <span class=\"number\">30</span>);</span><br><span class=\"line\">workbook.<span class=\"property\">modified</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>();</span><br><span class=\"line\">workbook.<span class=\"property\">lastPrinted</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(<span class=\"number\">2016</span>, <span class=\"number\">9</span>, <span class=\"number\">27</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 视图大小， 打开Excel时，整个框的位置，大小</span></span><br><span class=\"line\">workbook.<span class=\"property\">views</span> = [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"attr\">x</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"attr\">y</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"attr\">width</span>: <span class=\"number\">1000</span>,</span><br><span class=\"line\">        <span class=\"attr\">height</span>: <span class=\"number\">2000</span>,</span><br><span class=\"line\">        <span class=\"attr\">firstSheet</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"attr\">activeTab</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">visibility</span>: <span class=\"string\">&quot;visible&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 标签创建</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> worksheet = workbook.<span class=\"title function_\">addWorksheet</span>(<span class=\"string\">&quot;第一个标签&quot;</span>);</span><br><span class=\"line\">  <span class=\"comment\">// 带颜色的</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> worksheet2 = workbook.<span class=\"title function_\">addWorksheet</span>(<span class=\"string\">&quot;第二个标签&quot;</span>, &#123; <span class=\"attr\">properties</span>: &#123; <span class=\"attr\">tabColor</span>: &#123; <span class=\"attr\">argb</span>: <span class=\"string\">&quot;FFC0000&quot;</span> &#125; &#125; &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 遍历标签</span></span><br><span class=\"line\">workbook.<span class=\"title function_\">eachSheet</span>(<span class=\"function\">(<span class=\"params\">worksheet, sheetId</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;标签ID：&quot;</span>, sheetId)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"comment\">// console.log(worksheet);</span></span><br><span class=\"line\"><span class=\"comment\">// 删除一个标签</span></span><br><span class=\"line\">workbook.<span class=\"title function_\">removeWorksheet</span>(<span class=\"number\">2</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> firstSheet = workbook.<span class=\"title function_\">getWorksheet</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;标签信息-id&quot;</span>, firstSheet.<span class=\"property\">id</span>);</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;获取总的：行/实际行 /列/实际列 个数： &quot;</span>, firstSheet.<span class=\"property\">rowCount</span>, firstSheet.<span class=\"property\">actualColumnCount</span>, firstSheet.<span class=\"property\">columnCount</span>, firstSheet.<span class=\"property\">actualColumnCount</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 添加那个筛选箭头</span></span><br><span class=\"line\">worksheet.<span class=\"property\">autoFilter</span> = <span class=\"string\">&#x27;A1:C1&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getRow</span>(<span class=\"number\">5</span>).<span class=\"property\">font</span> = &#123; <span class=\"attr\">size</span>: <span class=\"number\">14</span>, <span class=\"attr\">bold</span>: <span class=\"literal\">true</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&quot;A2&quot;</span>).<span class=\"property\">value</span> = <span class=\"string\">&quot;Site&quot;</span>;</span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&quot;A2&quot;</span>).<span class=\"property\">font</span> = &#123;</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&quot;Arial Black&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">color</span>: &#123; <span class=\"attr\">argb</span>: <span class=\"string\">&quot;FF00FF00&quot;</span> &#125;,</span><br><span class=\"line\">    <span class=\"attr\">family</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"attr\">size</span>: <span class=\"number\">14</span>,</span><br><span class=\"line\">    <span class=\"attr\">italic</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"attr\">bold</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// save workbook to disk</span></span><br><span class=\"line\">workbook.<span class=\"property\">xlsx</span>.<span class=\"title function_\">writeFile</span>(<span class=\"string\">&quot;first.xlsx&quot;</span>).<span class=\"title function_\">then</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;saved&quot;</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"第三部分-行列的操作\"><a href=\"#第三部分-行列的操作\" class=\"headerlink\" title=\"第三部分 行列的操作\"></a>第三部分 行列的操作</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> <span class=\"title class_\">Excel</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;exceljs&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> workbook = <span class=\"keyword\">new</span> <span class=\"title class_\">Excel</span>.<span class=\"title class_\">Workbook</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 标签创建</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> worksheet = workbook.<span class=\"title function_\">addWorksheet</span>(<span class=\"string\">&quot;第一个标签&quot;</span>);</span><br><span class=\"line\"><span class=\"comment\">// 带颜色的</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> worksheet2 = workbook.<span class=\"title function_\">addWorksheet</span>(<span class=\"string\">&quot;第二个标签&quot;</span>, &#123;</span><br><span class=\"line\">    <span class=\"attr\">properties</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">tabColor</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">argb</span>: <span class=\"string\">&quot;FFC0000&quot;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// 设置列</span></span><br><span class=\"line\">worksheet.<span class=\"property\">columns</span> = [&#123;</span><br><span class=\"line\">        <span class=\"attr\">header</span>: <span class=\"string\">&#x27;Rating Period&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">key</span>: <span class=\"string\">&#x27;id&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">width</span>: <span class=\"number\">38</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"attr\">header</span>: <span class=\"string\">&#x27;Name&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">key</span>: <span class=\"string\">&#x27;name&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">width</span>: <span class=\"number\">32</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"attr\">header</span>: <span class=\"string\">&#x27;D.O.B.&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">key</span>: <span class=\"string\">&#x27;DOB&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">width</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">style</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">numFmt</span>: <span class=\"string\">&#x27;dd/mm/yyyy&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// 根据ID添加值</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">addRow</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">id</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;John Doe&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">dob</span>: <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(<span class=\"number\">1970</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">worksheet.<span class=\"title function_\">addRow</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">id</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;Jane Doe&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">dob</span>: <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(<span class=\"number\">1965</span>, <span class=\"number\">1</span>, <span class=\"number\">7</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"number\">1</span>).<span class=\"property\">value</span> = <span class=\"string\">&quot;Z&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 直接赋值</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A6&#x27;</span>).<span class=\"property\">value</span> = <span class=\"string\">&quot;1989&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 合并单元格</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">mergeCells</span>(<span class=\"string\">&#x27;A4:A7&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">// 合并四个格子</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">mergeCells</span>(<span class=\"string\">&#x27;A10&#x27;</span>, <span class=\"string\">&#x27;B11&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ===== 格式化显示，</span></span><br><span class=\"line\"><span class=\"comment\">// 数字 1.6 显示 &#x27;1 3/5&#x27;</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A1&#x27;</span>).<span class=\"property\">value</span> = <span class=\"number\">1.6</span>;</span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A1&#x27;</span>).<span class=\"property\">numFmt</span> = <span class=\"string\">&#x27;# ?/?&#x27;</span>;</span><br><span class=\"line\"><span class=\"comment\">// 显示 1.60%</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;B1&#x27;</span>).<span class=\"property\">value</span> = <span class=\"number\">0.016</span>;</span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;B1&#x27;</span>).<span class=\"property\">numFmt</span> = <span class=\"string\">&#x27;0.00%&#x27;</span>;</span><br><span class=\"line\"><span class=\"comment\">// ===== 字体显示</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A3&#x27;</span>).<span class=\"property\">font</span> = &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 字体名</span></span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;Comic Sans MS&#x27;</span>,</span><br><span class=\"line\">    <span class=\"comment\">// Font family for fallback. An integer value.</span></span><br><span class=\"line\">    <span class=\"attr\">family</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">    <span class=\"comment\">// 字体大小</span></span><br><span class=\"line\">    <span class=\"attr\">size</span>: <span class=\"number\">16</span>,</span><br><span class=\"line\">    <span class=\"comment\">// 下划线</span></span><br><span class=\"line\">    <span class=\"attr\">underline</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"comment\">// 加粗</span></span><br><span class=\"line\">    <span class=\"attr\">bold</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A3&#x27;</span>).<span class=\"property\">value</span> = <span class=\"string\">&quot;测试字体&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ==== 对齐方式</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A1&#x27;</span>).<span class=\"property\">alignment</span> = &#123;</span><br><span class=\"line\">    <span class=\"attr\">vertical</span>: <span class=\"string\">&#x27;top&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">horizontal</span>: <span class=\"string\">&#x27;left&#x27;</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;B1&#x27;</span>).<span class=\"property\">alignment</span> = &#123;</span><br><span class=\"line\">    <span class=\"attr\">vertical</span>: <span class=\"string\">&#x27;middle&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">horizontal</span>: <span class=\"string\">&#x27;center&#x27;</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;C1&#x27;</span>).<span class=\"property\">alignment</span> = &#123;</span><br><span class=\"line\">    <span class=\"attr\">vertical</span>: <span class=\"string\">&#x27;bottom&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">horizontal</span>: <span class=\"string\">&#x27;right&#x27;</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ===== 边框</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A1&#x27;</span>).<span class=\"property\">border</span> = &#123;</span><br><span class=\"line\">    <span class=\"attr\">top</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">style</span>: <span class=\"string\">&#x27;double&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">color</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">argb</span>: <span class=\"string\">&#x27;FF00FF00&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">left</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">style</span>: <span class=\"string\">&#x27;double&#x27;</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">bottom</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">style</span>: <span class=\"string\">&#x27;thin&#x27;</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">right</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">style</span>: <span class=\"string\">&#x27;thin&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ==== 填充颜色</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A1&#x27;</span>).<span class=\"property\">fill</span> = &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 模式</span></span><br><span class=\"line\">    <span class=\"attr\">type</span>: <span class=\"string\">&#x27;pattern&#x27;</span>,</span><br><span class=\"line\">    <span class=\"comment\">// 填充</span></span><br><span class=\"line\">    <span class=\"attr\">pattern</span>: <span class=\"string\">&#x27;solid&#x27;</span>,</span><br><span class=\"line\">    <span class=\"comment\">// fgColor: &#123;</span></span><br><span class=\"line\">    <span class=\"comment\">//     argb: &#x27;FFFF0000&#x27;</span></span><br><span class=\"line\">    <span class=\"comment\">// &#125;,</span></span><br><span class=\"line\">    <span class=\"comment\">// 背景色</span></span><br><span class=\"line\">    <span class=\"attr\">bgColor</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">argb</span>: <span class=\"string\">&#x27;FF0000FF&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">// 图片相关操作直接看GitHub就好</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 直接创建一个Excel表</span></span><br><span class=\"line\">workbook.<span class=\"property\">xlsx</span>.<span class=\"title function_\">writeFile</span>(<span class=\"string\">&quot;second.xlsx&quot;</span>).<span class=\"title function_\">then</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;saved&quot;</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>","more":"<p>工作中我们可能会遇到制作表格的需求，那么针对nodejs如何制作一个汇总表格呢？今天我们就在此介绍下<a href=\"https://github.com/guyonroche/exceljs\">exceljs</a>的基本使用，应该可以满足我们大部分的需求。</p>\n<h3 id=\"第一部分-下载\"><a href=\"#第一部分-下载\" class=\"headerlink\" title=\"第一部分 下载\"></a>第一部分 下载</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install exceljs</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"第二部分-基本的配置\"><a href=\"#第二部分-基本的配置\" class=\"headerlink\" title=\"第二部分 基本的配置\"></a>第二部分 基本的配置</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> <span class=\"title class_\">Excel</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;exceljs&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> workbook = <span class=\"keyword\">new</span> <span class=\"title class_\">Excel</span>.<span class=\"title class_\">Workbook</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 基本的创建信息</span></span><br><span class=\"line\">workbook.<span class=\"property\">creator</span> = <span class=\"string\">&quot;Me&quot;</span>;</span><br><span class=\"line\">workbook.<span class=\"property\">lastModifiedBy</span> = <span class=\"string\">&quot;Her&quot;</span>;</span><br><span class=\"line\">workbook.<span class=\"property\">created</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(<span class=\"number\">1985</span>, <span class=\"number\">8</span>, <span class=\"number\">30</span>);</span><br><span class=\"line\">workbook.<span class=\"property\">modified</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>();</span><br><span class=\"line\">workbook.<span class=\"property\">lastPrinted</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(<span class=\"number\">2016</span>, <span class=\"number\">9</span>, <span class=\"number\">27</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 视图大小， 打开Excel时，整个框的位置，大小</span></span><br><span class=\"line\">workbook.<span class=\"property\">views</span> = [</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"attr\">x</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"attr\">y</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"attr\">width</span>: <span class=\"number\">1000</span>,</span><br><span class=\"line\">        <span class=\"attr\">height</span>: <span class=\"number\">2000</span>,</span><br><span class=\"line\">        <span class=\"attr\">firstSheet</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"attr\">activeTab</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">        <span class=\"attr\">visibility</span>: <span class=\"string\">&quot;visible&quot;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 标签创建</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> worksheet = workbook.<span class=\"title function_\">addWorksheet</span>(<span class=\"string\">&quot;第一个标签&quot;</span>);</span><br><span class=\"line\">  <span class=\"comment\">// 带颜色的</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> worksheet2 = workbook.<span class=\"title function_\">addWorksheet</span>(<span class=\"string\">&quot;第二个标签&quot;</span>, &#123; <span class=\"attr\">properties</span>: &#123; <span class=\"attr\">tabColor</span>: &#123; <span class=\"attr\">argb</span>: <span class=\"string\">&quot;FFC0000&quot;</span> &#125; &#125; &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 遍历标签</span></span><br><span class=\"line\">workbook.<span class=\"title function_\">eachSheet</span>(<span class=\"function\">(<span class=\"params\">worksheet, sheetId</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;标签ID：&quot;</span>, sheetId)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"comment\">// console.log(worksheet);</span></span><br><span class=\"line\"><span class=\"comment\">// 删除一个标签</span></span><br><span class=\"line\">workbook.<span class=\"title function_\">removeWorksheet</span>(<span class=\"number\">2</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> firstSheet = workbook.<span class=\"title function_\">getWorksheet</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;标签信息-id&quot;</span>, firstSheet.<span class=\"property\">id</span>);</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;获取总的：行/实际行 /列/实际列 个数： &quot;</span>, firstSheet.<span class=\"property\">rowCount</span>, firstSheet.<span class=\"property\">actualColumnCount</span>, firstSheet.<span class=\"property\">columnCount</span>, firstSheet.<span class=\"property\">actualColumnCount</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 添加那个筛选箭头</span></span><br><span class=\"line\">worksheet.<span class=\"property\">autoFilter</span> = <span class=\"string\">&#x27;A1:C1&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getRow</span>(<span class=\"number\">5</span>).<span class=\"property\">font</span> = &#123; <span class=\"attr\">size</span>: <span class=\"number\">14</span>, <span class=\"attr\">bold</span>: <span class=\"literal\">true</span> &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&quot;A2&quot;</span>).<span class=\"property\">value</span> = <span class=\"string\">&quot;Site&quot;</span>;</span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&quot;A2&quot;</span>).<span class=\"property\">font</span> = &#123;</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&quot;Arial Black&quot;</span>,</span><br><span class=\"line\">    <span class=\"attr\">color</span>: &#123; <span class=\"attr\">argb</span>: <span class=\"string\">&quot;FF00FF00&quot;</span> &#125;,</span><br><span class=\"line\">    <span class=\"attr\">family</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"attr\">size</span>: <span class=\"number\">14</span>,</span><br><span class=\"line\">    <span class=\"attr\">italic</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"attr\">bold</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// save workbook to disk</span></span><br><span class=\"line\">workbook.<span class=\"property\">xlsx</span>.<span class=\"title function_\">writeFile</span>(<span class=\"string\">&quot;first.xlsx&quot;</span>).<span class=\"title function_\">then</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;saved&quot;</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"第三部分-行列的操作\"><a href=\"#第三部分-行列的操作\" class=\"headerlink\" title=\"第三部分 行列的操作\"></a>第三部分 行列的操作</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> <span class=\"title class_\">Excel</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;exceljs&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> workbook = <span class=\"keyword\">new</span> <span class=\"title class_\">Excel</span>.<span class=\"title class_\">Workbook</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 标签创建</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> worksheet = workbook.<span class=\"title function_\">addWorksheet</span>(<span class=\"string\">&quot;第一个标签&quot;</span>);</span><br><span class=\"line\"><span class=\"comment\">// 带颜色的</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> worksheet2 = workbook.<span class=\"title function_\">addWorksheet</span>(<span class=\"string\">&quot;第二个标签&quot;</span>, &#123;</span><br><span class=\"line\">    <span class=\"attr\">properties</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">tabColor</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">argb</span>: <span class=\"string\">&quot;FFC0000&quot;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// 设置列</span></span><br><span class=\"line\">worksheet.<span class=\"property\">columns</span> = [&#123;</span><br><span class=\"line\">        <span class=\"attr\">header</span>: <span class=\"string\">&#x27;Rating Period&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">key</span>: <span class=\"string\">&#x27;id&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">width</span>: <span class=\"number\">38</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"attr\">header</span>: <span class=\"string\">&#x27;Name&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">key</span>: <span class=\"string\">&#x27;name&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">width</span>: <span class=\"number\">32</span>,</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"attr\">header</span>: <span class=\"string\">&#x27;D.O.B.&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">key</span>: <span class=\"string\">&#x27;DOB&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">width</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">        <span class=\"attr\">style</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">numFmt</span>: <span class=\"string\">&#x27;dd/mm/yyyy&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/// 根据ID添加值</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">addRow</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">id</span>: <span class=\"number\">1</span>,</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;John Doe&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">dob</span>: <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(<span class=\"number\">1970</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">worksheet.<span class=\"title function_\">addRow</span>(&#123;</span><br><span class=\"line\">    <span class=\"attr\">id</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;Jane Doe&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">dob</span>: <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(<span class=\"number\">1965</span>, <span class=\"number\">1</span>, <span class=\"number\">7</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"number\">1</span>).<span class=\"property\">value</span> = <span class=\"string\">&quot;Z&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 直接赋值</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A6&#x27;</span>).<span class=\"property\">value</span> = <span class=\"string\">&quot;1989&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 合并单元格</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">mergeCells</span>(<span class=\"string\">&#x27;A4:A7&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">// 合并四个格子</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">mergeCells</span>(<span class=\"string\">&#x27;A10&#x27;</span>, <span class=\"string\">&#x27;B11&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ===== 格式化显示，</span></span><br><span class=\"line\"><span class=\"comment\">// 数字 1.6 显示 &#x27;1 3/5&#x27;</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A1&#x27;</span>).<span class=\"property\">value</span> = <span class=\"number\">1.6</span>;</span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A1&#x27;</span>).<span class=\"property\">numFmt</span> = <span class=\"string\">&#x27;# ?/?&#x27;</span>;</span><br><span class=\"line\"><span class=\"comment\">// 显示 1.60%</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;B1&#x27;</span>).<span class=\"property\">value</span> = <span class=\"number\">0.016</span>;</span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;B1&#x27;</span>).<span class=\"property\">numFmt</span> = <span class=\"string\">&#x27;0.00%&#x27;</span>;</span><br><span class=\"line\"><span class=\"comment\">// ===== 字体显示</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A3&#x27;</span>).<span class=\"property\">font</span> = &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 字体名</span></span><br><span class=\"line\">    <span class=\"attr\">name</span>: <span class=\"string\">&#x27;Comic Sans MS&#x27;</span>,</span><br><span class=\"line\">    <span class=\"comment\">// Font family for fallback. An integer value.</span></span><br><span class=\"line\">    <span class=\"attr\">family</span>: <span class=\"number\">4</span>,</span><br><span class=\"line\">    <span class=\"comment\">// 字体大小</span></span><br><span class=\"line\">    <span class=\"attr\">size</span>: <span class=\"number\">16</span>,</span><br><span class=\"line\">    <span class=\"comment\">// 下划线</span></span><br><span class=\"line\">    <span class=\"attr\">underline</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"comment\">// 加粗</span></span><br><span class=\"line\">    <span class=\"attr\">bold</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A3&#x27;</span>).<span class=\"property\">value</span> = <span class=\"string\">&quot;测试字体&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ==== 对齐方式</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A1&#x27;</span>).<span class=\"property\">alignment</span> = &#123;</span><br><span class=\"line\">    <span class=\"attr\">vertical</span>: <span class=\"string\">&#x27;top&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">horizontal</span>: <span class=\"string\">&#x27;left&#x27;</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;B1&#x27;</span>).<span class=\"property\">alignment</span> = &#123;</span><br><span class=\"line\">    <span class=\"attr\">vertical</span>: <span class=\"string\">&#x27;middle&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">horizontal</span>: <span class=\"string\">&#x27;center&#x27;</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;C1&#x27;</span>).<span class=\"property\">alignment</span> = &#123;</span><br><span class=\"line\">    <span class=\"attr\">vertical</span>: <span class=\"string\">&#x27;bottom&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">horizontal</span>: <span class=\"string\">&#x27;right&#x27;</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ===== 边框</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A1&#x27;</span>).<span class=\"property\">border</span> = &#123;</span><br><span class=\"line\">    <span class=\"attr\">top</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">style</span>: <span class=\"string\">&#x27;double&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">color</span>: &#123;</span><br><span class=\"line\">            <span class=\"attr\">argb</span>: <span class=\"string\">&#x27;FF00FF00&#x27;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">left</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">style</span>: <span class=\"string\">&#x27;double&#x27;</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">bottom</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">style</span>: <span class=\"string\">&#x27;thin&#x27;</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">right</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">style</span>: <span class=\"string\">&#x27;thin&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ==== 填充颜色</span></span><br><span class=\"line\">worksheet.<span class=\"title function_\">getCell</span>(<span class=\"string\">&#x27;A1&#x27;</span>).<span class=\"property\">fill</span> = &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 模式</span></span><br><span class=\"line\">    <span class=\"attr\">type</span>: <span class=\"string\">&#x27;pattern&#x27;</span>,</span><br><span class=\"line\">    <span class=\"comment\">// 填充</span></span><br><span class=\"line\">    <span class=\"attr\">pattern</span>: <span class=\"string\">&#x27;solid&#x27;</span>,</span><br><span class=\"line\">    <span class=\"comment\">// fgColor: &#123;</span></span><br><span class=\"line\">    <span class=\"comment\">//     argb: &#x27;FFFF0000&#x27;</span></span><br><span class=\"line\">    <span class=\"comment\">// &#125;,</span></span><br><span class=\"line\">    <span class=\"comment\">// 背景色</span></span><br><span class=\"line\">    <span class=\"attr\">bgColor</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">argb</span>: <span class=\"string\">&#x27;FF0000FF&#x27;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">// 图片相关操作直接看GitHub就好</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 直接创建一个Excel表</span></span><br><span class=\"line\">workbook.<span class=\"property\">xlsx</span>.<span class=\"title function_\">writeFile</span>(<span class=\"string\">&quot;second.xlsx&quot;</span>).<span class=\"title function_\">then</span>(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;saved&quot;</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>","categories":[{"name":"教程分享","path":"api/categories/教程分享.json"}],"tags":[{"name":"vue","path":"api/tags/vue.json"},{"name":"javascript","path":"api/tags/javascript.json"},{"name":"nodejs","path":"api/tags/nodejs.json"}]}