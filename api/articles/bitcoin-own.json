{"title":"比特币所有权及隐私问题-非对称加密应用","slug":"bitcoin-own","date":"2018-02-12T03:55:43.000Z","updated":"2022-10-19T14:40:00.242Z","comments":true,"path":"api/articles/bitcoin-own.json","realPath":"/2018/bitcoin-own/index/","excerpt":null,"covers":null,"cover":null,"content":"<p>比特币系统是如何确定某个账户的比特币是属于谁的？谁可以支付这个账户比特币？<br>如果你对这个问题还不是很明白，那就一起来看看吧。</p>\n<h2 id=\"银行系统\"><a href=\"#银行系统\" class=\"headerlink\" title=\"银行系统\"></a>银行系统</h2><p>我们先来回顾下现实的银行系统：</p>\n<ol>\n<li>首先我们需要把我们的个人信息（如身份证）给银行，银行给我们开立相对应的账户，银行在开户的时候确立了对账户的所有权。</li>\n<li>进行支付的时候，银行对交易双方完成转账（银行在开户的时候已经知道我们对应的账户）。<br>同时银行会对账户信息进行保密（这点其实不能保证）。</li>\n</ol>\n<h2 id=\"匿名账本\"><a href=\"#匿名账本\" class=\"headerlink\" title=\"匿名账本\"></a>匿名账本</h2><p>那么比特币如何在没有第三方银行的参与下，在确保隐私的同时如何确定账户所有权的呢？</p>\n<p>实际上比特币的账户是用地址来表示，账本上不显示个人信息，转账是把比特币从一个地址转移到另一个地址。<br>转账记录如这样：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;付款地址&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;2A39CBa2390FDe&quot;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;收款地址&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;AAC9CBa239aFcc&quot;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;金额&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;0.2btc&quot;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>接下来问题就变为了 谁有权用某个地址进行付款。</p>\n<blockquote>\n<p>支付和所有权 实际是同一个问题，如果此比特币只有我可以用来支付，那么说明我拥有所有权</p>\n</blockquote>\n<h2 id=\"地址与私钥\"><a href=\"#地址与私钥\" class=\"headerlink\" title=\"地址与私钥\"></a>地址与私钥</h2><p>比特币的解决方案是，谁拥有某个地址的私钥(如果完全没有加密概念的人，可以简单的把私钥当作密码)，谁就能用这个地址进行支付。（所以私钥一定保管好，如果私钥泄漏，比特币就可能丢失）</p>\n<p>比特币地址和私钥是一个非对称的关系，私钥经过一系列运算（其中有两次Hash）之后，可以得到地址, 但是无法从地址反推得到私钥。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">地址： 2A39CBa2390FDe</span><br><span class=\"line\">私钥： sdgHsdniNIhdsgaKIhkgnakgaihNKHIskdgal</span><br><span class=\"line\"></span><br><span class=\"line\">Hash(Hash(fun(sdgHsdniNIhdsgaKIhkgnakgaihNKHIskdgal)))  -&gt; 2A39CBa2390FDe</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>银行系统银行账号和密码是完全独立的，无法互相推导，转出时需要同时验证账号和密码</p>\n</blockquote>\n<p>还是上面交易的例子：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"string\">&quot;付款地址&quot;</span>：<span class=\"string\">&quot;2A39CBa2390FDe&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"string\">&quot;收款地址&quot;</span>：<span class=\"string\">&quot;AAC9CBa239aFcc&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"string\">&quot;金额&quot;</span>：<span class=\"string\">&quot;0.2btc&quot;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>只有拥有地址2A39CBa2390FDe的私钥才能进行支付。</p>\n<h2 id=\"非对称加密技术\"><a href=\"#非对称加密技术\" class=\"headerlink\" title=\"非对称加密技术\"></a>非对称加密技术</h2><p>这个时候问题就变为了，如何证明你拥有某个地址的私钥（在不泄漏私钥的情况下）。</p>\n<h3 id=\"对交易信息进行签名\"><a href=\"#对交易信息进行签名\" class=\"headerlink\" title=\"对交易信息进行签名\"></a>对交易信息进行签名</h3><p>实际在签名之前，会先对交易信息进行Hash运算得到摘要信息，然后对摘要信息进行签名。过程大概是这样：</p>\n<ol>\n<li>对交易进行hash， 得到一个摘要信息（Hash值）</li>\n</ol>\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hash(&#x27;</span><br><span class=\"line\">    &#123;&quot;付款地址&quot;：&quot;2A39CBa2390FDe&quot;,</span><br><span class=\"line\">    &quot;收款地址&quot;：&quot;AAC9CBa239aFcc&quot;,</span><br><span class=\"line\">    &quot;金额&quot;：&quot;0.2btc&quot;</span><br><span class=\"line\">    &#125;&#x27;) -&gt; 8aDB23CDEA6</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>用私钥对交易摘要进行签名（付款方在安全的环境下进行，以避免私钥泄密）, 用代码表示大概是这样。</li>\n</ol>\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#参数1为交易摘要</span><br><span class=\"line\">#参数2为私钥</span><br><span class=\"line\">#返回签名信息</span><br><span class=\"line\">sign(&quot;8aDB23CDEA6&quot;, &quot;J78sknJhidhLIqdngalket&quot;) -&gt; &quot;3cdferdadgadg&quot;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"广播\"><a href=\"#广播\" class=\"headerlink\" title=\"广播\"></a>广播</h3><p>在签名运算之后，付款节点就开始在全网进行广播：我支付了0.2btc到AAC9CBa239aFcc,签名信息是3cdferdadgadg，你们来确认一下吧。</p>\n<p>广播过程实际上是发信息到相连的其它节点，其它节点在验证通过后再转发到与之相连的节点，这样的扩散过程。</p>\n<p>广播的信息包含了交易原始信息和签名信息</p>\n<h3 id=\"验证\"><a href=\"#验证\" class=\"headerlink\" title=\"验证\"></a>验证</h3><p>其它节点在收到广播信息之后，会验证签名信息是不是付款方用私钥对交易原始信息签名产生的，如果验证通过说明确实是付款方本人发出的交易，说明交易有效，才会记录到账本中去。<br>（实际还会验证付款账号有没有足够的余额，我们暂时忽略这点）<br>验证过程实际是签名过程的逆运算，用代码表示大概过程是这样的：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#参数1为签名信息</span><br><span class=\"line\">#参数2为付款方地址</span><br><span class=\"line\">#返回交易摘要</span><br><span class=\"line\">verify(&quot;3cdferdadgadg&quot;, &quot;2A39CBa2390FDe&quot;) -&gt; &quot;8aDB23CDEA6&quot;</span><br></pre></td></tr></table></figure>\n\n<p>如果验证输出的信息和原始交易信息的hash一致，则验证通过，记录账本，用代码表示大概是这样：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if(verify(&quot;3cdferdadgadg&quot;, &quot;2A39CBa2390FDe&quot;)</span><br><span class=\"line\">    == hash(&#x27;&#123;&quot;付款地址&quot;：&quot;2A39CBa2390FDe&quot;,</span><br><span class=\"line\">              &quot;收款地址&quot;：&quot;AAC9CBa239aFcc&quot;,</span><br><span class=\"line\">              &quot;金额&quot;：&quot;0.2btc&quot;&#125;&#x27;)) :</span><br><span class=\"line\">    # 写入账本</span><br><span class=\"line\">    # 广播</span><br><span class=\"line\">else:</span><br><span class=\"line\">   # donothing</span><br></pre></td></tr></table></figure>\n\n<p>大家可以理解为付款地址为公钥，签名过程即为用私钥对交易摘要的加密过程，验证过程为用公钥解密的过程(为方便大家理解，严格来讲是不准确的)。</p>\n<h3 id=\"补充说明\"><a href=\"#补充说明\" class=\"headerlink\" title=\"补充说明\"></a>补充说明</h3><p>上面为了更好的理解，我对一些信息进行了简化。</p>\n<p>比特币系统使用了椭圆曲线签名算法，算法的私钥由32个字节随机数组成，通过私钥可以计算出公钥，公钥经过一序列哈希算法和编码算法得到比特币地址，地址也可以理解为公钥的摘要。</p>\n","more":"<p>比特币系统是如何确定某个账户的比特币是属于谁的？谁可以支付这个账户比特币？<br>如果你对这个问题还不是很明白，那就一起来看看吧。</p>\n<h2 id=\"银行系统\"><a href=\"#银行系统\" class=\"headerlink\" title=\"银行系统\"></a>银行系统</h2><p>我们先来回顾下现实的银行系统：</p>\n<ol>\n<li>首先我们需要把我们的个人信息（如身份证）给银行，银行给我们开立相对应的账户，银行在开户的时候确立了对账户的所有权。</li>\n<li>进行支付的时候，银行对交易双方完成转账（银行在开户的时候已经知道我们对应的账户）。<br>同时银行会对账户信息进行保密（这点其实不能保证）。</li>\n</ol>\n<h2 id=\"匿名账本\"><a href=\"#匿名账本\" class=\"headerlink\" title=\"匿名账本\"></a>匿名账本</h2><p>那么比特币如何在没有第三方银行的参与下，在确保隐私的同时如何确定账户所有权的呢？</p>\n<p>实际上比特币的账户是用地址来表示，账本上不显示个人信息，转账是把比特币从一个地址转移到另一个地址。<br>转账记录如这样：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;付款地址&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;2A39CBa2390FDe&quot;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;收款地址&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;AAC9CBa239aFcc&quot;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;金额&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;0.2btc&quot;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>接下来问题就变为了 谁有权用某个地址进行付款。</p>\n<blockquote>\n<p>支付和所有权 实际是同一个问题，如果此比特币只有我可以用来支付，那么说明我拥有所有权</p>\n</blockquote>\n<h2 id=\"地址与私钥\"><a href=\"#地址与私钥\" class=\"headerlink\" title=\"地址与私钥\"></a>地址与私钥</h2><p>比特币的解决方案是，谁拥有某个地址的私钥(如果完全没有加密概念的人，可以简单的把私钥当作密码)，谁就能用这个地址进行支付。（所以私钥一定保管好，如果私钥泄漏，比特币就可能丢失）</p>\n<p>比特币地址和私钥是一个非对称的关系，私钥经过一系列运算（其中有两次Hash）之后，可以得到地址, 但是无法从地址反推得到私钥。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">地址： 2A39CBa2390FDe</span><br><span class=\"line\">私钥： sdgHsdniNIhdsgaKIhkgnakgaihNKHIskdgal</span><br><span class=\"line\"></span><br><span class=\"line\">Hash(Hash(fun(sdgHsdniNIhdsgaKIhkgnakgaihNKHIskdgal)))  -&gt; 2A39CBa2390FDe</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>银行系统银行账号和密码是完全独立的，无法互相推导，转出时需要同时验证账号和密码</p>\n</blockquote>\n<p>还是上面交易的例子：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"string\">&quot;付款地址&quot;</span>：<span class=\"string\">&quot;2A39CBa2390FDe&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"string\">&quot;收款地址&quot;</span>：<span class=\"string\">&quot;AAC9CBa239aFcc&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"string\">&quot;金额&quot;</span>：<span class=\"string\">&quot;0.2btc&quot;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>只有拥有地址2A39CBa2390FDe的私钥才能进行支付。</p>\n<h2 id=\"非对称加密技术\"><a href=\"#非对称加密技术\" class=\"headerlink\" title=\"非对称加密技术\"></a>非对称加密技术</h2><p>这个时候问题就变为了，如何证明你拥有某个地址的私钥（在不泄漏私钥的情况下）。</p>\n<h3 id=\"对交易信息进行签名\"><a href=\"#对交易信息进行签名\" class=\"headerlink\" title=\"对交易信息进行签名\"></a>对交易信息进行签名</h3><p>实际在签名之前，会先对交易信息进行Hash运算得到摘要信息，然后对摘要信息进行签名。过程大概是这样：</p>\n<ol>\n<li>对交易进行hash， 得到一个摘要信息（Hash值）</li>\n</ol>\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hash(&#x27;</span><br><span class=\"line\">    &#123;&quot;付款地址&quot;：&quot;2A39CBa2390FDe&quot;,</span><br><span class=\"line\">    &quot;收款地址&quot;：&quot;AAC9CBa239aFcc&quot;,</span><br><span class=\"line\">    &quot;金额&quot;：&quot;0.2btc&quot;</span><br><span class=\"line\">    &#125;&#x27;) -&gt; 8aDB23CDEA6</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>用私钥对交易摘要进行签名（付款方在安全的环境下进行，以避免私钥泄密）, 用代码表示大概是这样。</li>\n</ol>\n  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#参数1为交易摘要</span><br><span class=\"line\">#参数2为私钥</span><br><span class=\"line\">#返回签名信息</span><br><span class=\"line\">sign(&quot;8aDB23CDEA6&quot;, &quot;J78sknJhidhLIqdngalket&quot;) -&gt; &quot;3cdferdadgadg&quot;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"广播\"><a href=\"#广播\" class=\"headerlink\" title=\"广播\"></a>广播</h3><p>在签名运算之后，付款节点就开始在全网进行广播：我支付了0.2btc到AAC9CBa239aFcc,签名信息是3cdferdadgadg，你们来确认一下吧。</p>\n<p>广播过程实际上是发信息到相连的其它节点，其它节点在验证通过后再转发到与之相连的节点，这样的扩散过程。</p>\n<p>广播的信息包含了交易原始信息和签名信息</p>\n<h3 id=\"验证\"><a href=\"#验证\" class=\"headerlink\" title=\"验证\"></a>验证</h3><p>其它节点在收到广播信息之后，会验证签名信息是不是付款方用私钥对交易原始信息签名产生的，如果验证通过说明确实是付款方本人发出的交易，说明交易有效，才会记录到账本中去。<br>（实际还会验证付款账号有没有足够的余额，我们暂时忽略这点）<br>验证过程实际是签名过程的逆运算，用代码表示大概过程是这样的：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#参数1为签名信息</span><br><span class=\"line\">#参数2为付款方地址</span><br><span class=\"line\">#返回交易摘要</span><br><span class=\"line\">verify(&quot;3cdferdadgadg&quot;, &quot;2A39CBa2390FDe&quot;) -&gt; &quot;8aDB23CDEA6&quot;</span><br></pre></td></tr></table></figure>\n\n<p>如果验证输出的信息和原始交易信息的hash一致，则验证通过，记录账本，用代码表示大概是这样：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if(verify(&quot;3cdferdadgadg&quot;, &quot;2A39CBa2390FDe&quot;)</span><br><span class=\"line\">    == hash(&#x27;&#123;&quot;付款地址&quot;：&quot;2A39CBa2390FDe&quot;,</span><br><span class=\"line\">              &quot;收款地址&quot;：&quot;AAC9CBa239aFcc&quot;,</span><br><span class=\"line\">              &quot;金额&quot;：&quot;0.2btc&quot;&#125;&#x27;)) :</span><br><span class=\"line\">    # 写入账本</span><br><span class=\"line\">    # 广播</span><br><span class=\"line\">else:</span><br><span class=\"line\">   # donothing</span><br></pre></td></tr></table></figure>\n\n<p>大家可以理解为付款地址为公钥，签名过程即为用私钥对交易摘要的加密过程，验证过程为用公钥解密的过程(为方便大家理解，严格来讲是不准确的)。</p>\n<h3 id=\"补充说明\"><a href=\"#补充说明\" class=\"headerlink\" title=\"补充说明\"></a>补充说明</h3><p>上面为了更好的理解，我对一些信息进行了简化。</p>\n<p>比特币系统使用了椭圆曲线签名算法，算法的私钥由32个字节随机数组成，通过私钥可以计算出公钥，公钥经过一序列哈希算法和编码算法得到比特币地址，地址也可以理解为公钥的摘要。</p>\n","categories":[{"name":"学习记录","path":"api/categories/学习记录.json"},{"name":"区块链","path":"api/categories/区块链.json"}],"tags":[{"name":"学习记录","path":"api/tags/学习记录.json"},{"name":"区块链","path":"api/tags/区块链.json"},{"name":"Python","path":"api/tags/Python.json"}]}